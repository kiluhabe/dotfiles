#!/usr/bin/env bash

CONNECTED="connected"
DISCONNECTED="disconnected"

DP_1_PREVIOUS_STATUS=$DISCONNECTED
eDP_1_PREVIOUS_STATUS=$DISCONNECTED

while :
do
    DP_1_CURRENT_STATUS=$(cat /sys/class/drm/card0-DP-1/status )
    eDP_1_CURRENT_STATUS=$(cat /sys/class/drm/card0-eDP-1/status )

    if [ $DP_1_PREVIOUS_STATUS != $DP_1_CURRENT_STATUS ] || [ $eDP_1_PREVIOUS_STATUS != $eDP_1_CURRENT_STATUS ]; then
        DP_1_PREVIOUS_STATUS=$DP_1_CURRENT_STATUS
        eDP_1_PREVIOUS_STATUS==$eDP_1_CURRENT_STATUS

        if [ $DP_1_CURRENT_STATUS = $CONNECTED ] && [ $eDP_1_CURRENT_STATUS = $CONNECTED ]; then
            xrandr --output eDP-1 --auto --output DP-1 --auto
        fi
        if [ $DP_1_CURRENT_STATUS = $CONNECTED ] && [ $eDP_1_CURRENT_STATUS = $DISCONNECTED ]; then
            xrandr --output eDP-1 --off --output DP-1 --auto
        fi
        if [ $DP_1_CURRENT_STATUS = $DISCONNECTED ] && [ $eDP_1_CURRENT_STATUS = $CONNECTED ]; then
            xrandr --output eDP-1 --auto --output DP-1 --off
        fi

    fi
    sleep 1
done
